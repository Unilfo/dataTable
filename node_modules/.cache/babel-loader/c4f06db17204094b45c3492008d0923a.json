{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport { useEffect, useMemo, useState, useRef, useCallback } from 'react';\nimport highlightReducer from './highlightReducer';\nimport getDisplayValue from './lib/getDisplayValue';\nimport flattenOptions from './lib/flattenOptions';\nimport GroupOptions from './lib/groupOptions';\nimport getNewValue from './lib/getNewValue';\nimport getOption from './lib/getOption';\nimport doSearch from './search';\nexport default function useSelectSearch({\n  value: defaultValue = null,\n  disabled = false,\n  multiple = false,\n  search: canSearch = false,\n  fuse = false,\n  options: defaultOptions,\n  onChange = () => {},\n  getOptions = null,\n  allowEmpty = true,\n  closeOnSelect = true\n}) {\n  const ref = useRef(null);\n  const flatDefaultOptions = useMemo(() => flattenOptions(defaultOptions), [defaultOptions]);\n  const [state, setState] = useState({\n    flat: [],\n    addedOptions: [],\n    value: defaultValue,\n    search: '',\n    focus: false,\n    searching: false,\n    highlighted: -1,\n    changed: false\n  });\n  const {\n    flat,\n    addedOptions,\n    value,\n    search,\n    focus,\n    searching,\n    highlighted\n  } = state;\n  const option = useMemo(() => {\n    let newOption = getOption(value, [...flatDefaultOptions, ...addedOptions]);\n\n    if (!newOption && !allowEmpty && !multiple) {\n      [newOption] = flatDefaultOptions;\n    }\n\n    return newOption;\n  }, [value, flatDefaultOptions, addedOptions, allowEmpty, multiple]);\n  const options = useMemo(() => GroupOptions(flat), [flat]);\n  const displayValue = useMemo(() => getDisplayValue(option), [option]);\n  const onBlur = useCallback(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      focus: false,\n      search: '',\n      flat: flatDefaultOptions,\n      highlighted: -1\n    }));\n\n    if (ref.current) {\n      ref.current.blur();\n    }\n  }, [flatDefaultOptions, ref]);\n\n  const setFocus = newFocus => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    focus: newFocus\n  }));\n\n  const onClick = () => setFocus(!focus);\n\n  const onFocus = () => setFocus(true);\n\n  const onSelect = useCallback(val => {\n    setState(oldState => {\n      const item = val || oldState.flat[oldState.highlighted].value;\n      const values = getNewValue(item, oldState.value, multiple);\n      const newOptions = getOption(values, oldState.flat);\n      return _objectSpread(_objectSpread({}, oldState), {}, {\n        addedOptions: multiple ? newOptions : [newOptions],\n        value: values,\n        changed: [values, newOptions]\n      });\n    });\n  }, [multiple]);\n  const onMouseDown = useCallback(e => {\n    if (!closeOnSelect || multiple) {\n      e.preventDefault();\n\n      if (multiple) {\n        e.target.focus();\n      }\n    }\n\n    onSelect(e.currentTarget.value);\n  }, [onSelect, closeOnSelect, multiple]);\n  const onKeyDown = useCallback(e => {\n    const {\n      key\n    } = e;\n\n    if (key === 'ArrowDown' || key === 'ArrowUp') {\n      e.preventDefault();\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        highlighted: highlightReducer(oldState.highlighted, {\n          key,\n          options: oldState.flat\n        })\n      }));\n    }\n  }, []);\n  const onKeyPress = useCallback(({\n    key\n  }) => {\n    if (key === 'Enter') {\n      onSelect();\n\n      if (!multiple && closeOnSelect) {\n        onBlur();\n      }\n    }\n  }, [onSelect, multiple, closeOnSelect, onBlur]);\n  const onKeyUp = useCallback(({\n    key\n  }) => {\n    if (key === 'Escape') {\n      onBlur();\n    }\n  }, [onBlur]);\n\n  const onSearch = ({\n    target\n  }) => {\n    const {\n      value: inputVal\n    } = target;\n    const newState = {\n      search: inputVal\n    };\n    let searchableOption = flatDefaultOptions;\n\n    if (getOptions && inputVal.length) {\n      newState.searching = true;\n      searchableOption = getOptions(inputVal);\n    }\n\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), newState));\n    Promise.resolve(searchableOption).then(foundOptions => {\n      let newOptions = foundOptions;\n\n      if (inputVal.length) {\n        newOptions = doSearch(inputVal, foundOptions, fuse);\n      }\n\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        flat: newOptions === false ? foundOptions : newOptions,\n        searching: false\n      }));\n    }).catch(() => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions,\n      searching: false\n    })));\n  };\n\n  const valueProps = {\n    tabIndex: '0',\n    readOnly: !canSearch,\n    onChange: canSearch ? onSearch : null,\n    disabled,\n    onMouseDown: onClick,\n    onBlur,\n    onFocus,\n    onKeyPress,\n    onKeyDown,\n    onKeyUp,\n    ref\n  };\n  const optionProps = useMemo(() => ({\n    tabIndex: '-1',\n    onMouseDown,\n    onKeyDown,\n    onKeyPress,\n    onBlur\n  }), [onMouseDown, onKeyDown, onKeyPress, onBlur]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      value: defaultValue\n    }));\n  }, [defaultValue]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions\n    }));\n  }, [flatDefaultOptions]);\n  useEffect(() => {\n    if (state.changed !== false) {\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        changed: false\n      }));\n      onChange(...state.changed);\n    }\n  }, [state.changed, onChange]);\n  return [{\n    value: option,\n    highlighted,\n    options,\n    disabled,\n    displayValue,\n    focus,\n    search,\n    searching\n  }, valueProps, optionProps, newValue => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    value: newValue\n  }))];\n}","map":{"version":3,"sources":["F:/Application/dataTable/data-table/node_modules/react-select-search/dist/esm/useSelect.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","useEffect","useMemo","useState","useRef","useCallback","highlightReducer","getDisplayValue","flattenOptions","GroupOptions","getNewValue","getOption","doSearch","useSelectSearch","defaultValue","disabled","multiple","search","canSearch","fuse","options","defaultOptions","onChange","getOptions","allowEmpty","closeOnSelect","ref","flatDefaultOptions","state","setState","flat","addedOptions","focus","searching","highlighted","changed","option","newOption","displayValue","onBlur","oldState","current","blur","setFocus","newFocus","onClick","onFocus","onSelect","val","item","values","newOptions","onMouseDown","e","preventDefault","currentTarget","onKeyDown","onKeyPress","onKeyUp","onSearch","inputVal","newState","searchableOption","Promise","resolve","then","foundOptions","catch","valueProps","tabIndex","readOnly","optionProps","newValue"],"mappings":"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","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useEffect, useMemo, useState, useRef, useCallback } from 'react';\nimport highlightReducer from './highlightReducer';\nimport getDisplayValue from './lib/getDisplayValue';\nimport flattenOptions from './lib/flattenOptions';\nimport GroupOptions from './lib/groupOptions';\nimport getNewValue from './lib/getNewValue';\nimport getOption from './lib/getOption';\nimport doSearch from './search';\nexport default function useSelectSearch({\n  value: defaultValue = null,\n  disabled = false,\n  multiple = false,\n  search: canSearch = false,\n  fuse = false,\n  options: defaultOptions,\n  onChange = () => {},\n  getOptions = null,\n  allowEmpty = true,\n  closeOnSelect = true\n}) {\n  const ref = useRef(null);\n  const flatDefaultOptions = useMemo(() => flattenOptions(defaultOptions), [defaultOptions]);\n  const [state, setState] = useState({\n    flat: [],\n    addedOptions: [],\n    value: defaultValue,\n    search: '',\n    focus: false,\n    searching: false,\n    highlighted: -1,\n    changed: false\n  });\n  const {\n    flat,\n    addedOptions,\n    value,\n    search,\n    focus,\n    searching,\n    highlighted\n  } = state;\n  const option = useMemo(() => {\n    let newOption = getOption(value, [...flatDefaultOptions, ...addedOptions]);\n\n    if (!newOption && !allowEmpty && !multiple) {\n      [newOption] = flatDefaultOptions;\n    }\n\n    return newOption;\n  }, [value, flatDefaultOptions, addedOptions, allowEmpty, multiple]);\n  const options = useMemo(() => GroupOptions(flat), [flat]);\n  const displayValue = useMemo(() => getDisplayValue(option), [option]);\n  const onBlur = useCallback(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      focus: false,\n      search: '',\n      flat: flatDefaultOptions,\n      highlighted: -1\n    }));\n\n    if (ref.current) {\n      ref.current.blur();\n    }\n  }, [flatDefaultOptions, ref]);\n\n  const setFocus = newFocus => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    focus: newFocus\n  }));\n\n  const onClick = () => setFocus(!focus);\n\n  const onFocus = () => setFocus(true);\n\n  const onSelect = useCallback(val => {\n    setState(oldState => {\n      const item = val || oldState.flat[oldState.highlighted].value;\n      const values = getNewValue(item, oldState.value, multiple);\n      const newOptions = getOption(values, oldState.flat);\n      return _objectSpread(_objectSpread({}, oldState), {}, {\n        addedOptions: multiple ? newOptions : [newOptions],\n        value: values,\n        changed: [values, newOptions]\n      });\n    });\n  }, [multiple]);\n  const onMouseDown = useCallback(e => {\n    if (!closeOnSelect || multiple) {\n      e.preventDefault();\n\n      if (multiple) {\n        e.target.focus();\n      }\n    }\n\n    onSelect(e.currentTarget.value);\n  }, [onSelect, closeOnSelect, multiple]);\n  const onKeyDown = useCallback(e => {\n    const {\n      key\n    } = e;\n\n    if (key === 'ArrowDown' || key === 'ArrowUp') {\n      e.preventDefault();\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        highlighted: highlightReducer(oldState.highlighted, {\n          key,\n          options: oldState.flat\n        })\n      }));\n    }\n  }, []);\n  const onKeyPress = useCallback(({\n    key\n  }) => {\n    if (key === 'Enter') {\n      onSelect();\n\n      if (!multiple && closeOnSelect) {\n        onBlur();\n      }\n    }\n  }, [onSelect, multiple, closeOnSelect, onBlur]);\n  const onKeyUp = useCallback(({\n    key\n  }) => {\n    if (key === 'Escape') {\n      onBlur();\n    }\n  }, [onBlur]);\n\n  const onSearch = ({\n    target\n  }) => {\n    const {\n      value: inputVal\n    } = target;\n    const newState = {\n      search: inputVal\n    };\n    let searchableOption = flatDefaultOptions;\n\n    if (getOptions && inputVal.length) {\n      newState.searching = true;\n      searchableOption = getOptions(inputVal);\n    }\n\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), newState));\n    Promise.resolve(searchableOption).then(foundOptions => {\n      let newOptions = foundOptions;\n\n      if (inputVal.length) {\n        newOptions = doSearch(inputVal, foundOptions, fuse);\n      }\n\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        flat: newOptions === false ? foundOptions : newOptions,\n        searching: false\n      }));\n    }).catch(() => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions,\n      searching: false\n    })));\n  };\n\n  const valueProps = {\n    tabIndex: '0',\n    readOnly: !canSearch,\n    onChange: canSearch ? onSearch : null,\n    disabled,\n    onMouseDown: onClick,\n    onBlur,\n    onFocus,\n    onKeyPress,\n    onKeyDown,\n    onKeyUp,\n    ref\n  };\n  const optionProps = useMemo(() => ({\n    tabIndex: '-1',\n    onMouseDown,\n    onKeyDown,\n    onKeyPress,\n    onBlur\n  }), [onMouseDown, onKeyDown, onKeyPress, onBlur]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      value: defaultValue\n    }));\n  }, [defaultValue]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions\n    }));\n  }, [flatDefaultOptions]);\n  useEffect(() => {\n    if (state.changed !== false) {\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        changed: false\n      }));\n      onChange(...state.changed);\n    }\n  }, [state.changed, onChange]);\n  return [{\n    value: option,\n    highlighted,\n    options,\n    disabled,\n    displayValue,\n    focus,\n    search,\n    searching\n  }, valueProps, optionProps, newValue => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    value: newValue\n  }))];\n}"]},"metadata":{},"sourceType":"module"}